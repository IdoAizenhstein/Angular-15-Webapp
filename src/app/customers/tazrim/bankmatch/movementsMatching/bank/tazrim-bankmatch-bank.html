<div class="lineAccBankMatchAccountNav">
  <div style="display: flex">
    <div id="bankMatchAccountNav">
      <div id="groupAcc">
        <div
          *ngIf="nav.prev"
          id="prevScroll"
          (mouseenter)="prevScroll(navBanks, true)"
          (mouseleave)="scrollRobotStop($event)"
        >
          <i class="fas fa-angle-right"></i>
        </div>
        <ul style="overflow-x: hidden; white-space: nowrap" #navBanks>
          <li
            *ngFor="let acc of userService.appData.userData.bankMatchAccount"
            [hidden]="router.url.includes('casflow') && acc.countNigrarot === 0"
          >
            <div
              style="display: flex"
              [class.active]="
                userService.appData.userData.bankMatchAccountAcc
                  ?.companyAccountId === acc.companyAccountId
              "
              (click)="setBankAcc(acc)"
            >
              <!--<img *ngIf="acc.bankIconSrc" style="height: auto; width: auto; position: relative;" fill [ngSrc]="acc.bankIconSrc">-->
              <img
                style="height: auto; width: auto; position: relative;" fill [ngSrc]="
                  (acc.companyAccountId | asBankAccount).bankId
                    | toIconSrc: 'bank'
                "
                [alt]="acc.accountNickname"
              />

              <div class="text-ellipsis">
                {{ acc.accountNickname }} {{ acc.currency | currencySymbol }}
              </div>
              <i
                [matTooltip]="
                  'appWalk.customers.tazrim.bankmatch.opsToMatchCounter'
                    | translate
                "
                matTooltipPosition="below"
              >
                {{ acc.countNigrarot > 99 ? '99+' : acc.countNigrarot }}
              </i>
            </div>
          </li>
        </ul>
        <div
          *ngIf="nav.next"
          id="nextScroll"
          (mouseenter)="nextScroll(navBanks, true)"
          (mouseleave)="scrollRobotStop($event)"
        >
          <i class="fas fa-angle-left"></i>
        </div>
      </div>
      <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/replace.png" alt="replace" width="32" height="20" id="replace"-->
      <!--[pTooltip]="'החלפת טבלאות'" [escape]="false" tooltipPosition="bottom" (click)="replace()">-->
    </div>
    <div id="navTabs">
      <ul class="tabs">
        <li
          routerLink="./"
          queryParamsHandling="preserve"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
          [matTooltip]="
            'appWalk.customers.tazrim.bankmatch.opsToMatch' | translate
          "
          matTooltipPosition="below"
          [title]="'תנועות להתאמה'"
        >
          {{ 'תנועות להתאמה' }}
        </li>
        <li
          routerLink="./matched"
          queryParamsHandling="preserve"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
          [matTooltip]="
            'appWalk.customers.tazrim.bankmatch.opsMatched' | translate
          "
          matTooltipPosition="below"
          [title]="'תנועות שהותאמו'"
        >
          {{ 'תנועות שהותאמו' }}
        </li>
      </ul>
    </div>
  </div>
</div>
<div
  *ngIf="
    userService?.appData?.userData?.bankMatchAccountAcc?.countNigrarot > 25 &&
    !userService?.appData?.userData?.bankMatchAccountAcc?.closeAlert
  "
  class="countNigrarot"
>
  <div>
    <b> שימו לב: </b>
    הצטברו מעל 25 תנועות שהיו צפויות להתאמה לחשבון זה.
    <br />
    תוכלו "לפתוח דף חדש" ולמחוק את הפריטים שלא הותאמו. המחיקה לא תשפיע על תנועות
    הבנק בפועל.
  </div>
  <div>
    מחיקת תנועות שלא הותאמו, עד לפני
    <input
      type="text"
      [(ngModel)]="daysToDelete"
      [class.err]="daysToDelete === '' || daysToDelete < 0"
      appNumbersOnly="positiveInt"
    />
    ימים

    <button
      (click)="openPopEdit()"
      [disabled]="daysToDelete === '' || daysToDelete < 0"
      class="button-dark"
    >
      מחיקה
    </button>
  </div>
  <img
    style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/closeAlert.png"
    alt="close"
    (click)="userService.appData.userData.bankMatchAccountAcc.closeAlert = true"
  />
</div>

<div class="twoTables" style="position: relative">
  <div
    class="banktransForMatch"
    [class.isBorder]="banktransForMatchAll?.length"
  >
    <div class="title" [class.notUpdate]="accountSelectOneNotUpdate">
      <i
        [matTooltip]="
          'appWalk.customers.tazrim.bankmatch.unexpectedOpsHeader' | translate
        "
        matTooltipPosition="below"
        style="line-height: 1em"
      >
        תנועות בנק שלא צפיתי / לא הותאמו
      </i>

      <div class="search">
        <input
          id="containTextFilter"
          type="text"
          autocomplete="off"
          placeholder="{{ 'filters.search' | translate }}"
          [formControl]="filterInput"
        />
      </div>
    </div>
    <div *ngIf="loader" class="loader">
      <div class="circle"></div>
    </div>
    <div
      class="searchRow"
      *ngIf="banktransForMatchAll?.length"
      style="justify-content: space-between"
    >
      <ng-container
        *ngIf="
          userService.appData.userData.bankMatchAccountAcc && hasRowOfDeleted;
          else noSelectedRows
        "
      >
        <span
          [innerHTML]="
            'expressions.markedTransactionsSummaryPtrn'
              | translate
                : {
                    sum: (hasRowOfDeleted.sum | sum),
                    currency:
                      ((
                        userService.appData.userData.bankMatchAccountAcc
                          .companyAccountId | asBankAccount
                      ).currency | currencySymbol),
                    size: hasRowOfDeleted.size
                  }
          "
        ></span>
        <!--{{('expressions.markedTransactionsSummaryPtrn'| translate:{ sum:(hasRowOfDeleted.sum| sum),-->
        <!--currency: ((userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).currency| currencySymbol),-->
        <!--size: hasRowOfDeleted.size})}}-->
        <!--{{hasRowOfDeleted| json}}-->
      </ng-container>
      <ng-template #noSelectedRows>
        {{ 'expressions.markTransactionsForMatch' | translate }}
      </ng-template>

      <div
        *ngIf="
          userService.appData.userData.bankMatchAccountAcc &&
          accountSelectOneNotUpdate &&
          !hasRowOfDeleted
        "
        class="accountSelectOneNotUpdate"
      >
        <app-account-outdated-view
          [account]="
            userService.appData.userData.bankMatchAccountAcc.companyAccountId
              | asBankAccount
          "
        ></app-account-outdated-view>
        <!--<app-token-credentials-update-button-->
        <!--[balanceLastUpdatedDate]="(userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).balanceLastUpdatedDate"-->
        <!--[tokenData]="{-->
        <!--companyId: userService.appData.userData.companySelect.companyId,-->
        <!--tokenId:(userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).token-->
        <!--}">-->
        <!--</app-token-credentials-update-button>-->
      </div>
      <!--<div class="search">-->
      <!--<input id="containTextFilter"-->
      <!--type="text" autocomplete="off"-->
      <!--placeholder="{{'filters.search'|translate}}"-->
      <!--[value]="queryString"-->
      <!--[formControl]="filterInput">-->
      <!--</div>-->
      <div *ngIf="hasRowOfDeleted && !hasRowOfChecked" class="btnDelete">
        <button class="button-dark" (click)="openPopBankMatchDelete()">
          למחוק
        </button>
      </div>
    </div>
    <div
      class="bank-acc-details-table-container tableBanktransForMatch"
      style="position: relative"
      *ngIf="banktransForMatchAll?.length"
    >
      <div class="bank-acc-details-table-header" #banktransForMatchHeader>
        <div class="bank-acc-details-column-1">
          <div>{{ 'titles.description' | translate }}</div>
        </div>
        <div
          class="bank-acc-details-column-beneficiary"
          style="overflow: visible"
        >
          <app-tooltip-category
            [type]="'biziboxMutavId'"
            [filter]="true"
            [data]="beneficiaryFilter.bank.options"
            (changed)="filterBeneficiaries('bank', $event)"
          >
            <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-header-icon.png" />
          </app-tooltip-category>
        </div>
        <div class="bank-acc-details-column-2" style="overflow: visible">
          <div>
            <app-tooltip-category
              [title]="'titles.typeOfPayment' | translate"
              [type]="'payment'"
              [data]="paymentTypesArr"
              [translateEnum]="sharedService.paymentTypesTranslate$"
              (changed)="filterCategory($event)"
            ></app-tooltip-category>
          </div>
        </div>
        <div class="bank-acc-details-column-3" (click)="sortPipeFilter(1)">
          {{ 'titles.date' | translate }}
          <img
            style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0" fill [ngSrc]="
              '/assets/images/sort-' +
              (sortPipeDirDate === 'smaller' ? 'asc' : 'desc') +
              '.png'
            "
          />
        </div>
        <div class="bank-acc-details-column-4" (click)="sortPipeFilter(2)">
          <div>
            {{ 'titles.sum' | translate }}
            <img
              style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0" fill [ngSrc]="
                '/assets/images/sort-' +
                (sortPipeDir === 'smaller' ? 'asc' : 'desc') +
                '.png'
              "
            />
          </div>
        </div>
      </div>
      <div
        class="containerList scrollbar-dynamic bank-acc-details-table-body"
        style="position: relative"
        [ngStyle]="{'height': (getPageHeightFunc(banktransForMatchHeader.getBoundingClientRect().bottom + 10)) +'px'}"
      >
	      <div *ngIf="loader" class="loader">
		      <div class="circle"></div>
	      </div>
	      <ng-scrollbar
			      #scrollbarCompanies
			      (updated)="onScroll(scrollbarCompanies)"
			      class="custom-scrollbar"
			      thumbClass="scrollbar-thumb"
			      trackClass="scrollbar">
		    
		      <cdk-virtual-scroll-viewport #virtualScroll itemSize="46" scrollViewport>
			      <div *cdkVirtualFor="let item of banktransForMatch; let i = index; trackBy: trackById">
				      <div
						      class="bank-acc-details-row"
						      [class.bank-acc-details-row-selected]="
                item.deleteRow || item?.bankTransId === tooltipElem?.transId
              "
				      >
					      <div
							      class="bank-acc-details-column-1"
							      style="display: flex; align-items: center"
					      >
						      <p-checkbox checkboxIcon="fa fa-check"
						                  [binary]="true"
						                  [disabled]="item.checkDisabled"
						                  (onChange)="
                    item.deleteRow = !item.deleteRow; checkDeleted()
                  "
						                  [ngModel]="item.deleteRow"
						      >
						      </p-checkbox>
						
						      <div
								      class="text-ellipsis"
								      [innerHTML]="
                    item.transDescAzonly | highlight: filterInput.value
                  "
								      [pTooltip]="item.transDescAzonly"
								      tooltipPosition="top"
								      style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
						      ></div>
					      </div>
					
					      <div class="bank-acc-details-column-beneficiary">
						      <ng-container *ngIf="item.mutavNames?.length">
							      <img
									      style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-row-icon.png"
									      [pTooltip]="item.mutavNames.join(', ')"
									      tooltipPosition="top"
							      />
						      </ng-container>
					      </div>
					
					      <div class="bank-acc-details-column-2">
						      <div
								      [appTransactionAdditionalTrigger]="item"
								      [class.bank-acc-details-link]="
                    item.linkId || item.pictureLink
                  "
								      class="text-ellipsis"
								      [innerHTML]="
                    item.paymentDescTranslate | highlight: filterInput.value
                  "
						      ></div>
						      <div
								      class="text-ellipsis"
								      [innerHTML]="item.asmachta | highlight: filterInput.value"
						      ></div>
					      </div>
					      <div class="bank-acc-details-column-3">
						      <div
								      [innerHTML]="
                    item.transDateStr
                      | highlight: (searchInDates ? filterInput.value : '')
                  "
						      ></div>
						      <div>{{ item.transDate | todayRelativeHumanize: 'days' }}</div>
					      </div>
					      <div class="bank-acc-details-column-4" style="position: relative">
						      <div
								      class="ltrNum"
								      [class.sum-debit]="item.hova"
								      [class.sum-credit]="!item.hova"
						      >
							      <app-sum-view
									      class="text-ellipsis"
									      [sum]="item.total"
									      [highlight]="filterInput.value"
							      >
							      </app-sum-view>
						      </div>
						      <div>
							      <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png" style="width: 14px;vertical-align: middle;"-->
							      <!--(click)="openPopBankMatchDelete(item)"/>-->
							      <i
									      class="fas fa-ellipsis-v"
									      *ngIf="item.isCyclic"
									      [matTooltip]="
                      'appWalk.customers.tazrim.bankmatch.unexpectedOpActionHandler'
                        | translate
                    "
									      matTooltipPosition="before"
									      (click)="openTooltip($event, 162, item.bankTransId, item)"
							      ></i>
							      <!--                                       (click)="openTooltip($event, 102, item.bankTransId, item);"></i>-->
						      </div>
					      </div>
					      <!--<div class="arrow-right"-->
					      <!--*ngIf="showAdditionalItem && showAdditionalItem.bankTransId === item.bankTransId"></div>-->
				      </div>
			      </div>
		      </cdk-virtual-scroll-viewport>
	      </ng-scrollbar>
	      
        <div
          class="no-rows-found"
          *ngIf="
            !loader && banktransForMatchAll?.length && !banktransForMatch.length
          "
        >
          {{ 'expressions.noDataFoundForCriteria' | translate }},
          {{ 'expressions.changeCriteria' | translate }}
        </div>
      </div>
    </div>
    <div
      *ngIf="banktransForMatchAll && !banktransForMatchAll?.length"
      class="notData"
    >
      <p>לא קיימות תנועות בנק שלא צפיתי / לא הותאמו</p>
    </div>
  </div>

  <div class="banktransForMatch" [class.isBorder]="cashflowMatchAll?.length">
    <div class="title">
      <i
        [matTooltip]="
          'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpsHeader'
            | translate
        "
        matTooltipPosition="below"
        style="line-height: 1em"
      >
        תנועות תזרים צפויות שטרם קרו / לא הותאמו
      </i>
      <div class="search">
        <input
          id="containTextFilterUnadjusted"
          type="text"
          autocomplete="off"
          placeholder="{{ 'filters.search' | translate }}"
          [formControl]="filterInputUnadjusted"
        />
      </div>
    </div>
    <div *ngIf="loaderCash" class="loader">
      <div class="circle"></div>
    </div>
    <div class="searchRow" *ngIf="cashflowMatchAll?.length">
      <!--<div class="search" style="margin: 0;">-->
      <!--<input id="containTextFilterUnadjusted"-->
      <!--type="text" autocomplete="off"-->
      <!--placeholder="{{'filters.search'|translate}}"-->
      <!--[formControl]="filterInputUnadjusted">-->
      <!--</div>-->
      <!--{{'expressions.markTransactionsForMatch'| translate}}-->
      <ng-container
        *ngIf="
          userService.appData.userData.bankMatchAccountAcc && hasRowOfChecked;
          else noSelectedRows
        "
      >
        <span
          [innerHTML]="
            'expressions.markedTransactionsSummaryPtrn'
              | translate
                : {
                    sum: (hasRowOfChecked.sum | sum),
                    currency:
                      ((
                        userService.appData.userData.bankMatchAccountAcc
                          .companyAccountId | asBankAccount
                      ).currency | currencySymbol),
                    size: hasRowOfChecked.size
                  }
          "
        ></span>
        <!--{{('expressions.markedTransactionsSummaryPtrn'| translate:{ sum:(hasRowOfChecked.sum| sum),-->
        <!--currency: ((userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).currency| currencySymbol),-->
        <!--size: hasRowOfChecked.size})}}-->
        <!--{{hasRowOfChecked| json}}-->
      </ng-container>
      <ng-template #noSelectedRows>
        {{ 'expressions.markTransactionsForMatch' | translate }}
      </ng-template>

      <div class="btnGroup" *ngIf="hasRowOfChecked && !hasRowOfDeleted">
        <button class="button-dark" (click)="onMultiPostponeClick()">
          לדחות
        </button>
        <button
          class="button-dark"
          (click)="rolloutDeleteOperationConfirmPrompt()"
        >
          <!--<button class="button-dark" (click)="onMultiDeleteClick()">-->
          למחוק
        </button>
      </div>

      <!--[style.pointer-events]="!(cashflowMatchReco?.length) || currentTab === 0 ? 'none' : 'auto'"-->
      <ul class="tabs" *ngIf="!hasRowOfChecked || hasRowOfDeleted">
        <li
          (click)="checkReco()"
          [matTooltip]="
            'appWalk.customers.tazrim.bankmatch.recommendedOpsBtn' | translate
          "
          matTooltipPosition="below"
          [matTooltipDisabled]="!cashflowMatchReco?.length"
          [class.disabled]="!cashflowMatchReco?.length"
          [style.pointer-events]="!cashflowMatchReco?.length ? 'none' : 'auto'"
          [class.active]="currentTab === 0"
        >
          מומלצות
        </li>
        <li
          (click)="currentTab = 1; filtersAllCash()"
          [style.pointer-events]="currentTab === 1 ? 'none' : 'auto'"
          [class.active]="currentTab === 1"
        >
          הכל
        </li>
      </ul>
    </div>
    <div
      class="bank-acc-details-table-container tableBanktransForMatch"
      style="position: relative"
      *ngIf="cashflowMatchAll?.length"
    >
      <div class="bank-acc-details-table-header" #cashflowMatchHeader>
        <div class="bank-acc-details-column-1">
          <div style="display: flex; align-items: center">
            <!--<p-checkbox checkboxIcon="fa fa-check" [binary]="true"-->
            <!--[disabled]="checkAllRowsDisabled"-->
            <!--(onChange)="checkAllRows=!checkAllRows;checkAllRowsFunc()"-->
            <!--[(ngModel)]="checkAllRows">-->
            <!--</p-checkbox>-->
            <div class="text-ellipsis">
              {{ 'titles.description' | translate }}
            </div>
          </div>
        </div>
        <div
          class="bank-acc-details-column-beneficiary"
          style="overflow: visible"
        >
          <app-tooltip-category
            [type]="'biziboxMutavId'"
            [filter]="true"
            [data]="beneficiaryFilter.cashflow.options"
            (changed)="filterBeneficiaries('cashflow', $event)"
          >
            <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-header-icon.png" />
          </app-tooltip-category>
        </div>
        <div class="bank-acc-details-column-2">
          <!--{{'titles.methodsOfPayment'|translate}}-->
          <div>
            <app-tooltip-category
              [title]="'titles.typeOfPayment' | translate"
              [type]="'payment'"
              [data]="cashPaymentTypesArr"
              [translateEnum]="sharedService.paymentTypesTranslate$"
              (changed)="filterCashCategory($event)"
            ></app-tooltip-category>
          </div>
        </div>
        <div class="bank-acc-details-column-3" (click)="sortPipeFilterCash(1)">
          {{ 'titles.expectedToDate' | translate }}
          <img
            style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0" fill [ngSrc]="
              '/assets/images/sort-' +
              (sortPipeDirCashDate === 'smaller' ? 'asc' : 'desc') +
              '.png'
            "
          />
        </div>
        <div class="bank-acc-details-column-4" (click)="sortPipeFilterCash(2)">
          <div>
            {{ 'titles.sum' | translate }}
            <img
              style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0" fill [ngSrc]="
                '/assets/images/sort-' +
                (sortPipeDirCash === 'smaller' ? 'asc' : 'desc') +
                '.png'
              "
            />
          </div>
        </div>
      </div>
      <div
        [appScrollHeight]="
          cashflowMatchHeader.getBoundingClientRect().bottom + 10
        "
        class="containerList scrollbar-dynamic bank-acc-details-table-body"
        style="position: relative"
        (scroll)="tooltipElem = null"
      >
        <div *ngIf="cashflowMatch?.partialMatch?.children.length">
          <div
            class="bank-acc-details-row titleRow"
            [class.opened]="cashflowMatch.partialMatch.parent.opened"
            (click)="
              cashflowMatch.partialMatch.parent.opened =
                !cashflowMatch.partialMatch.parent.opened
            "
          >
            <div>
              <i
                class="fa fa-fw"
                [ngClass]="
                  cashflowMatch.partialMatch.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
              ></i>
              {{ 'expressions.partialMatch' | translate }}
            </div>
          </div>
          <div *ngIf="cashflowMatch.partialMatch.parent.opened">
            <div
              *ngFor="
                let item of cashflowMatch.partialMatch.children;
                trackBy: trackById
              "
            >
              <div
                class="bank-acc-details-row"
                [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
              >
                <div
                  class="bank-acc-details-column-1"
                  style="display: flex; align-items: center"
                >
                  <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                    <p-checkbox checkboxIcon="fa fa-check"
                      [binary]="true"
                      [disabled]="item.checkDisabled"
                      (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item)
                      "
                      [ngModel]="item.checkRow"
                    >
                    </p-checkbox>
                  </ng-container>

                  <div
                    class="text-ellipsis"
                    style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                    [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                    [pTooltip]="item.targetName"
                    tooltipPosition="top"
                  ></div>
                </div>

                <div class="bank-acc-details-column-beneficiary">
                  <ng-container *ngIf="item.mutavNames?.length">
                    <img
                      style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-row-icon.png"
                      [pTooltip]="item.mutavNames.join(', ')"
                      tooltipPosition="top"
                    />
                  </ng-container>
                </div>

                <div class="bank-acc-details-column-2" style="display: flex">
                  <div
                    *ngIf="item.targetAsmachta; else singleRowCell"
                    class="text-ellipsis"
                    [pTooltip]="item.paymentDescTranslate"
                    tooltipPosition="top"
                  >
                    <div
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                    <div
                      style="color: #a7a3a3"
                      [innerHTML]="
                        item.targetAsmachta
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                  </div>
                  <ng-template #singleRowCell>
                    <div
                      class="text-ellipsis"
                      [pTooltip]="item.paymentDescTranslate"
                      tooltipPosition="top"
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                  </ng-template>

                  <div
                    [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                    class="periodic-trans-indication"
                  >
                    <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/periodic-trans.png" />
                  </div>
                </div>
                <div class="bank-acc-details-column-3">
                  <div>{{ 'sumsTitles.today' | translate }}</div>
                  <div>
                    {{
                      item.targetOriginalDate | todayRelativeHumanize: 'drugged'
                    }}
                  </div>
                </div>
                <div
                  class="bank-acc-details-column-4"
                  style="position: relative"
                >
                  <div
                    class="ltrNum"
                    [class.sum-debit]="item.expence"
                    [class.sum-credit]="!item.expence"
                  >
                    <app-sum-view
                      class="text-ellipsis"
                      [sum]="item.targetOriginalTotal"
                      [highlight]="filterInputUnadjusted.value"
                    >
                    </app-sum-view>
                  </div>
                  <div>
                    <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                    <!--style="width: 14px;vertical-align: middle;"/>-->
                    <i
                      class="fas fa-ellipsis-v"
                      [matTooltip]="
                        'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpActionHandler'
                          | translate
                      "
                      matTooltipPosition="before"
                      (click)="openTooltip($event, 235, item.targetId, item)"
                    ></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="cashflowMatch?.nigreret?.children.length">
          <div
            class="bank-acc-details-row titleRow"
            [class.opened]="cashflowMatch.nigreret.parent.opened"
            (click)="
              cashflowMatch.nigreret.parent.opened =
                !cashflowMatch.nigreret.parent.opened
            "
          >
            <div>
              <i
                class="fa fa-fw"
                [ngClass]="
                  cashflowMatch.nigreret.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
              ></i>
              {{ 'expressions.movementsOutstandingNotAdjusted' | translate }}
            </div>
          </div>
          <div *ngIf="cashflowMatch.nigreret.parent.opened">
            <div
              *ngFor="
                let item of cashflowMatch.nigreret.children;
                trackBy: trackById
              "
            >
              <div
                class="bank-acc-details-row"
                [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
              >
                <div
                  class="bank-acc-details-column-1"
                  style="display: flex; align-items: center"
                >
                  <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                    <p-checkbox checkboxIcon="fa fa-check"
                      [binary]="true"
                      [disabled]="item.checkDisabled"
                      (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item)
                      "
                      [ngModel]="item.checkRow"
                    >
                    </p-checkbox>
                  </ng-container>

                  <div
                    class="text-ellipsis"
                    style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                    [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                    [pTooltip]="item.targetName"
                    tooltipPosition="top"
                  ></div>
                </div>

                <div class="bank-acc-details-column-beneficiary">
                  <ng-container *ngIf="item.mutavNames?.length">
                    <img
                      style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-row-icon.png"
                      [pTooltip]="item.mutavNames.join(', ')"
                      tooltipPosition="top"
                    />
                  </ng-container>
                </div>

                <div class="bank-acc-details-column-2" style="display: flex">
                  <div
                    *ngIf="item.targetAsmachta; else singleRowCell"
                    class="text-ellipsis"
                    [pTooltip]="item.paymentDescTranslate"
                    tooltipPosition="top"
                  >
                    <div
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                    <div
                      style="color: #a7a3a3"
                      [innerHTML]="
                        item.targetAsmachta
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                  </div>
                  <ng-template #singleRowCell>
                    <div
                      class="text-ellipsis"
                      [pTooltip]="item.paymentDescTranslate"
                      tooltipPosition="top"
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                  </ng-template>

                  <div
                    [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                    class="periodic-trans-indication"
                  >
                    <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/periodic-trans.png" />
                  </div>
                </div>
                <div class="bank-acc-details-column-3">
                  <div>{{ 'sumsTitles.today' | translate }}</div>
                  <div>
                    {{
                      item.targetOriginalDate | todayRelativeHumanize: 'drugged'
                    }}
                  </div>
                </div>
                <div
                  class="bank-acc-details-column-4"
                  style="position: relative"
                >
                  <div
                    class="ltrNum"
                    [class.sum-debit]="item.expence"
                    [class.sum-credit]="!item.expence"
                  >
                    <app-sum-view
                      class="text-ellipsis"
                      [sum]="item.targetOriginalTotal"
                      [highlight]="filterInputUnadjusted.value"
                    >
                    </app-sum-view>
                  </div>
                  <div>
                    <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                    <!--style="width: 14px;vertical-align: middle;"/>-->
                    <i
                      class="fas fa-ellipsis-v"
                      [matTooltip]="
                        'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpActionHandler'
                          | translate
                      "
                      matTooltipPosition="before"
                      (click)="openTooltip($event, 235, item.targetId, item)"
                    ></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="cashflowMatch?.future?.children.length">
          <div
            class="bank-acc-details-row titleRow"
            [class.opened]="cashflowMatch.future.parent.opened"
            (click)="
              cashflowMatch.future.parent.opened =
                !cashflowMatch.future.parent.opened
            "
          >
            <div>
              <i
                class="fa fa-fw"
                [ngClass]="
                  cashflowMatch.future.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
              ></i>
              {{ 'expressions.futureMovements' | translate }}
            </div>
          </div>
          <div *ngIf="cashflowMatch.future.parent.opened">
            <div
              *ngFor="
                let item of cashflowMatch.future.children;
                trackBy: trackById
              "
            >
              <div
                class="bank-acc-details-row"
                [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
              >
                <div
                  class="bank-acc-details-column-1"
                  style="display: flex; align-items: center"
                >
                  <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                    <p-checkbox checkboxIcon="fa fa-check"
                      [binary]="true"
                      [disabled]="item.checkDisabled"
                      (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item)
                      "
                      [ngModel]="item.checkRow"
                    >
                    </p-checkbox>
                  </ng-container>

                  <div
                    class="text-ellipsis"
                    style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                    [pTooltip]="item.targetName"
                    tooltipPosition="top"
                    [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                  ></div>
                </div>

                <div class="bank-acc-details-column-beneficiary">
                  <ng-container *ngIf="item.mutavNames?.length">
                    <img
                      style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/beneficiary-row-icon.png"
                      [pTooltip]="item.mutavNames.join(', ')"
                      tooltipPosition="top"
                    />
                  </ng-container>
                </div>

                <div class="bank-acc-details-column-2" style="display: flex">
                  <div
                    *ngIf="item.targetAsmachta; else singleRowCell"
                    class="text-ellipsis"
                    [pTooltip]="item.paymentDescTranslate"
                    tooltipPosition="top"
                  >
                    <div
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                    <div style="color: #a7a3a3">{{ item.targetAsmachta }}</div>
                  </div>
                  <ng-template #singleRowCell>
                    <div
                      class="text-ellipsis"
                      [pTooltip]="item.paymentDescTranslate"
                      tooltipPosition="top"
                      [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                    ></div>
                  </ng-template>
                  <!--                                    <div class="text-ellipsis"-->
                  <!--                                         [innerHTML]="item.paymentDescTranslate| highlight: filterInputUnadjusted.value">-->
                  <!--                                    </div>-->

                  <div
                    [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                    class="periodic-trans-indication"
                  >
                    <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/periodic-trans.png" />
                  </div>
                </div>
                <div class="bank-acc-details-column-3">
                  <div>
                    {{ item.transDateFull | date: 'dd/MM/yy' }}
                    <!--{{item.transDateHumanizedStr}}-->
                  </div>
                  <div>
                    {{ item.transDateFull | todayRelativeHumanize: 'days' }}
                  </div>
                </div>
                <div
                  class="bank-acc-details-column-4"
                  style="position: relative"
                >
                  <div
                    class="ltrNum"
                    [class.sum-debit]="item.expence"
                    [class.sum-credit]="!item.expence"
                  >
                    <app-sum-view
                      class="text-ellipsis"
                      [sum]="item.targetOriginalTotal"
                      [highlight]="filterInputUnadjusted.value"
                    >
                    </app-sum-view>
                  </div>
                  <div>
                    <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                    <!--style="width: 14px;vertical-align: middle;"/>-->
                    <i
                      class="fas fa-ellipsis-v"
                      (click)="openTooltip($event, 235, item.targetId, item)"
                    ></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="no-rows-found"
          *ngIf="
            !loaderCash &&
            !cashflowMatch?.nigreret?.children.length &&
            !cashflowMatch?.partialMatch?.children.length &&
            !cashflowMatch?.future?.children.length
          "
        >
          {{ 'expressions.noDataFoundForCriteria' | translate }},
          {{ 'expressions.changeCriteria' | translate }}
        </div>
      </div>
    </div>

    <!--<div class="no-rows-found"-->
    <!--*ngIf="!loaderCash && cashflowMatchAll?.length && !cashflowMatch?.nigreret?.children.length && !cashflowMatch?.future?.children.length">-->
    <!--{{'expressions.noDataFoundForCriteria'| translate}}, {{'expressions.changeCriteria'| translate}}-->
    <!--</div>-->

    <div *ngIf="cashflowMatchAll && !cashflowMatchAll?.length" class="notData">
      <ng-container
        *ngIf="
          banktransForMatchAll && banktransForMatchAll.length;
          else bothTablesEmptyMessage
        "
      >
        <p>
          ■ כל התנועות הצפויות הותאמו אך מופיעות בבנק תנועות נוספות שלא היו
          צפויות
        </p>
        <p>
          ■ אם אחת או יותר מתנועות הבנק שנותרו הן מחזוריות אנא הוסיפו אותן
          לתזרים
        </p>
        <p>■ בידקו אם קיימות תנועות שמקורן בטעות מצד הבנק</p>
        <p>■ שאר התנועות הן כנראה תנועות חד פעמיות לא צפויות</p>

        <div
          *ngIf="
            userService?.appData?.userData?.bankMatchAccount?.length > 1 &&
            userService?.appData?.userData?.bankMatchAccountAcc
              ?.companyAccountId !==
              userService?.appData?.userData?.bankMatchAccount[
                userService?.appData?.userData?.bankMatchAccount?.length - 1
              ].companyAccountId
          "
        >
          <span class="link" (click)="moveToNextAcc()">
            מעבר לחשבון הבא >>
          </span>
        </div>
      </ng-container>
      <ng-template #bothTablesEmptyMessage>
        לא קיימות תנועות צפויות שטרם קרו / לא הותאמו
      </ng-template>
    </div>
  </div>

  <!--<div class="toast" *ngIf="hasRowOfChecked && hasRowOfDeleted && !cancelMatch && matchList">-->
  <!--<div>-->
  <!--<span (click)="bankMatch()">-->
  <!--התאמת הפריטים המסומנים-->
  <!--</span>-->
  <!--</div>-->
  <!--<div>-->
  <!--<span (click)="cancelMatch = true">-->
  <!--ביטול-->
  <!--</span>-->
  <!--</div>-->
  <!--</div>-->
  <p-dialog
    *ngIf="hasRowOfChecked && hasRowOfDeleted && !cancelMatch && matchList"
    #matchApprovePrompt
    [visible]="true"
    (visibleChange)="cancelMatch = true"
    appendTo="body"
    [modal]="false"
    [styleClass]="'match-list-prompt'"
    [resizable]="false"
    position="top"
    [style]="{'margin-top':'76px'}"
    [closable]="false"
  >
    <p-header>
      <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/matching-big.png" />
    </p-header>
    <!--{{matchList.selectedUniqueBeneficiaryKeys| json}}-->
    <p *ngIf="matchList.selectedTransTypeIds.size > 1">
      {{ 'expressions.variantCategoriesSelected' | translate }}
    </p>
    <!--        <ng-container *ngIf="matchList.selectedUniqueBeneficiaryKeys.size < 2; else variantBeneficiariesSelected">-->
    <!--            <p *ngIf="matchList.selectedTransTypeIds.size > 1">-->
    <!--                {{'expressions.variantCategoriesSelected'| translate}}-->
    <!--            </p>-->
    <!--        </ng-container>-->
    <!--        <ng-template #variantBeneficiariesSelected>-->
    <!--            <p id="variantBeneficiariesSelected">-->
    <!--                {{'expressions.variantBeneficiariesSelected'| translate}}<br/>-->
    <!--                <small><i class="fa fa-fw fa-info-circle"></i>{{'expressions.editTransactionProposal'| translate}}-->
    <!--                </small>-->
    <!--            </p>-->
    <!--        </ng-template>-->
    <!--{{matchList| json}}-->
    <!--        {{matchApprovePromptLastPosition| json}}-->
    <p-footer>
      <a
        href="javascript:void(0)"
        role="button"
        class="button-white button-link"
        (click)="cancelMatch = true"
      >
        {{ 'actions.cancellation' | translate }}
      </a>
      <button class="button-dark" type="button" (click)="bankMatch()">
        <!--{{matchList.array.length}}-->
        {{
          'expressions.matchMarkedTransactionsPtrn'
            | translate: { length: matchList.selectedCount }
        }}
      </button>
      <!--            <ng-container *ngIf="matchList.selectedUniqueBeneficiaryKeys.size < 2">-->
      <!--                <button class="button-dark" type="button" (click)="bankMatch()">-->
      <!--                    &lt;!&ndash;{{matchList.array.length}}&ndash;&gt;-->
      <!--                    {{'expressions.matchMarkedTransactionsPtrn'| translate: ({length: matchList.selectedCount})}}-->
      <!--                </button>-->
      <!--            </ng-container>-->
    </p-footer>
  </p-dialog>

  <p-dialog (visibleChange)="showModalAutoMatch = false"
		  [visible]="(showModalAutoMatch)"
		
    (onHide)="showModalAutoMatch = false"
    appendTo="body"
    [modal]="true"
    [resizable]="false"
    styleClass="modalEditCardsBeforeSend"
  >
    <p-header>
      <h1>התאמה אוטומטית</h1>
    </p-header>

    <p style="text-align: right">
      האם ברצונך להתאים את {{ modalAutoMatch?.transDescAzonly }}
      <br />
      לתנועה הקבועה {{ modalAutoMatch?.targetName }} עבור -
    </p>

    <ul *ngIf="matchList && matchList.array && matchList.array.length">
      <li>
        <p-radioButton
          name="changeOption"
          [label]="'תנועה זו בלבד'"
          [value]="false"
          [(ngModel)]="matchList.array[0].searchkeyUpdate"
          [inputId]="'setFieldValueForFuture1'"
        ></p-radioButton>
      </li>
      <li>
        <p-radioButton
          name="changeOption"
          [label]="'תנועות עתיד (מהיום קדימה)'"
          [value]="true"
          [(ngModel)]="matchList.array[0].searchkeyUpdate"
          [inputId]="'setFieldValueForFuture2'"
        ></p-radioButton>
      </li>
    </ul>
    <p-footer>
      <button class="button-link" (click)="showModalAutoMatch = false">
        {{ 'actions.cancellation' | translate }}
      </button>
      <button class="button-dark" (click)="showToastBeforeSendRun()">
        {{ 'actions.approve' | translate }}
      </button>
    </p-footer>
  </p-dialog>

  <p-dialog (visibleChange)="cashflowMatchPopup = false"
		  [visible]="(cashflowMatchPopup)"
		
    *ngIf="cashflowMatchPopup"
    styleClass="cashflowMatchPopup"
    appendTo="body"
    [draggable]="false"
    [resizable]="false"
    [style]="{width: 480 + 'px',height: 300 + 'px'}"
    [modal]="false"
  >
    <p-header>
      <div class="transDescAzonly">
        תנועת הבנק:
        {{ cashflowMatchPopup?.banktransRow?.transDescAzonly }} בסכום
        <span>{{ cashflowMatchPopup?.banktransRow?.total }}</span>
      </div>
      <div class="secondTitle">
        תותאם לתנועות שנבחרו ע”פ הסכום שהיה בתזרים. ניתן לשנות את הסכומים לפני
        ההתאמה
      </div>
    </p-header>

    <form [formGroup]="cashflowMatchPopup.table">
      <div class="tableSplit">
        <div class="header">
          <div>תיאור התנועה</div>
          <div>{{ 'titles.typeOfPayment' | translate }}</div>
          <div>{{ 'titles.sum' | translate }}</div>
          <div
            style="
              flex: 0 0 0.8em;
              -ms-flex: 0 0 0.8em;
              padding: 0;
              margin-left: 0;
            "
            *ngIf="scrollContainerInsideHasScroll"
          >
            &nbsp;
          </div>
        </div>

        <ul
          class="scroll-chrome table"
          #scrollContainerInside
          formArrayName="arr"
        >
          <li
            *ngFor="let item of arr.controls; let i = index"
            [formGroupName]="i"
          >
            <div>{{ item.value.targetName }}</div>
            <div style="overflow: visible; display: flex; flex-direction: row">
              {{ item.value.paymentDescTranslate }}

              <div
                [style.visibility]="
                  item.value.isPeriodicType ? 'visible' : 'hidden'
                "
                class="periodic-trans-indication"
              >
                <img src="/assets/images/periodic-trans.png" />
              </div>
            </div>
            <div
              [class.validation-error]="
                arr.controls[i].get('userMatchTotal').dirty &&
                arr.controls[i].get('userMatchTotal').invalid
              "
            >
              <input
                type="text"
                (keyup)="calcSumTotals()"
                formControlName="userMatchTotal"
                #totalFields
                required
                appNumbersOnly="numWithTwoDec"
              />
            </div>
          </li>
        </ul>
      </div>
    </form>

    <p-footer>
      <div
        style="
          width: 100%;
          display: flex;
          display: -ms-flexbox;
          justify-content: flex-end;
        "
      >
        <div
          *ngIf="
            cashflowMatchPopup?.sumTotals >
            cashflowMatchPopup?.banktransRow?.total
          "
          class="alertSumRed"
        >
          שימו לב, הסכום הכולל גבוה ב{{
            cashflowMatchPopup?.sumTotals -
              cashflowMatchPopup?.banktransRow?.total | sum
          }}
          <ng-container
            *ngIf="cashflowMatchPopup.banktransRow.account.currency === 'ILS'"
            >ש"ח</ng-container
          >
          <br />
          מהסכום בבנק
        </div>
        <button
          class="button-white button-link"
          (click)="cashflowMatchPopup = false"
        >
          {{ 'actions.cancellation' | translate }}
        </button>
        <button class="button-dark" type="submit" (click)="bankMatchSubmit()">
          התאמת {{ arr.controls.length }} התנועות
        </button>
      </div>
    </p-footer>
  </p-dialog>

  <!--<div class="toast" *ngIf="showToastBeforeSend && matchList">-->
  <!--<div class="toastFlex">-->
  <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/check.png" alt="v" width="18" height="15">-->

  <!--{{matchList.array.length}}-->

  <!--<i *ngIf="matchList.array.length > 1">-->
  <!--תנועות הותאמו-->
  <!--</i>-->
  <!--<i *ngIf="matchList.array.length === 1">-->
  <!--תנועה הותאמה-->
  <!--</i>-->
  <!--</div>-->
  <!--<div>-->
  <!--<span (click)="showToastBeforeSend = false">-->
  <!--שיחזור-->
  <!--</span>-->
  <!--</div>-->
  <!--</div>-->
  <p-dialog
    *ngIf="showToastBeforeSend && matchList"
    [visible]="true"
    (visibleChange)="showToastBeforeSend = false"
    appendTo="body"
    [modal]="false"
    [styleClass]="'match-list-prompt'"
    [resizable]="false"
    position="top"
    [style]="{'margin-top':'96px'}"
    [closable]="false"
  >
    <p-header>
      <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/matching-big.png" />
    </p-header>
    <!--{{matchList| json}}-->
    <p-footer>
      <div>
        <!--{{matchList.array.length}}-->
        <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/check.png" alt="v" />&nbsp;{{
          'expressions.transactionsMatchedSuccessfully' | translate
        }}
      </div>

      <a
        href="javascript:void(0)"
        role="button"
        class="button-white button-link"
        (click)="showToastBeforeSend = false"
      >
        {{ 'actions.restore' | translate }}
      </a>
    </p-footer>
  </p-dialog>

  <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/replace.png" alt="replace" id="replace"-->
  <!--[pTooltip]="'החלפת טבלאות'" [escape]="false" tooltipPosition="bottom" (click)="replace()">-->
</div>

<div
  *ngIf="tooltipElem"
  [style.left.px]="tooltipElem.x"
  [style.top.px]="tooltipElem.y"
  class="tooltipElem"
  [style.height.px]="
    tooltipElem.height -
    (tooltipElem.height === 235 && tooltipElem.hidePostponeAction === true
      ? 72
      : 0)
  "
  [ngClass]="{
    'arrow-up': tooltipElem.arrow === 'up',
    'arrow-bottom': tooltipElem.arrow === 'bottom'
  }"
>
  <div *ngIf="tooltipElem.height !== 235" class="content">
    <!--    <div *ngIf="tooltipElem.height === 162" class="content">-->
    <p>אין צורך בהתאמה?</p>
    <button
      class="button-dark"
      (click)="openPopBankMatchDelete(tooltipElem.itemFull)"
    >
      מחיקה מהרשימה
    </button>
    <p>תנועה קבועה?</p>
    <button
      class="button-dark"
      (click)="createFromRecommendationData.visible = true"
    >
      הוספה לתזרים
    </button>
  </div>
  <div *ngIf="tooltipElem.height === 235" class="content">
    <p *ngIf="!tooltipElem?.hidePostponeAction">צפויה לקרות בקרוב?</p>
    <button
      class="button-dark"
      (click)="postponePrompt.visible = true"
      *ngIf="!tooltipElem?.hidePostponeAction"
    >
      כן, לדחות
    </button>
    <p>לא צפויה לקרות/קרתה?</p>
    <!--<button class="button-dark" (click)="deleteConfirmationPrompt.visible = true;">-->
    <button
      class="button-dark"
      (click)="rolloutDeleteOperationConfirmPrompt(tooltipElem.itemFull)"
    >
      למחוק מהתזרים
    </button>
    <p>הפרטים לא מדוייקים?</p>
    <button class="button-dark" (click)="editMovementShow()">
      עריכת תנועה
    </button>
  </div>
  <div class="arrow"></div>
</div>

<p-dialog (visibleChange)="popUpDeleteMatch = false"
  *ngIf="popUpDeleteMatch"
  [visible]="(popUpDeleteMatch)"

  appendTo="body"
  [modal]="true"
  [styleClass]="popUpDeleteMatch.styleClass"
  [style]="{width: popUpDeleteMatch.width + 'px',height: popUpDeleteMatch.height + 'px'}"

  (onHide)="popUpDeleteMatch = false"
>
  <p-header>
    <div>
      {{
        popUpDeleteMatch.lenOfChecked === 1 || popUpDeleteMatch.isItemDirect
          ? 'מחיקת פעולה'
          : 'מחיקת פעולות'
      }}
    </div>
  </p-header>
  <div class="bodyPopUp">
    <p>
      <ng-container
        *ngIf="
          popUpDeleteMatch.lenOfChecked === 1 || popUpDeleteMatch.isItemDirect;
          else multi
        "
      >
        התנועה
        <strong>"{{ popUpDeleteMatch.desc }}"</strong>
        תימחק מהרשימה.<br />
        האם להמשיך? המחיקה לא תשפיע על תנועת הבנק בפועל
      </ng-container>
    </p>
    <ng-template #multi>
      התנועות שנבחרו ימחקו מהרשימה.<br />
      האם להמשיך? המחיקה לא תשפיע על תנועת הבנק בפועל
      <!--התנועות הנבחרות יוסרו מרשימת תנועות בנק שלא צפיתי/הותאמו.-->
    </ng-template>
  </div>
  <p-footer>
    <a
      href="javascript:void(0)"
      role="button"
      class="button-white button-link"
      (click)="popUpDeleteMatch = false"
    >
      {{ 'actions.cancellation' | translate }}
    </a>

    <button class="button-dark" type="button" (click)="bankMatchDelete()">
      {{ 'actions.remove' | translate }}
    </button>
  </p-footer>
</p-dialog>

<p-dialog (visibleChange)="userService.appData.popUpShow = false"
  *ngIf="userService.appData.popUpShow"
  [visible]="(userService.appData.popUpShow)"
  appendTo="body"
  [modal]="true"
  [styleClass]="userService.appData.popUpShow.styleClass"
  [style]="{width: userService.appData.popUpShow.width + 'px',height: userService.appData.popUpShow.height + 'px'}"

  (onHide)="userService.appData.popUpShow = false"
>
  <p-header *ngIf="userService.appData.popUpShow.header">
    <div>מחיקת תנועות שלא הותאמו</div>
  </p-header>
  <div class="bodyPopUp" *ngIf="userService.appData.popUpShow.body">
    שימו לב: המערכת תמחוק תנועות צפויות
    <br />
    שלא הותאמו, עד לפני
    <input
      type="text"
      [(ngModel)]="userService.appData.popUpShow.daysToDelete"
      [class.err]="
        userService.appData.popUpShow.daysToDelete === '' ||
        userService.appData.popUpShow.daysToDelete < 0
      "
      appNumbersOnly="positiveInt"
    />
    ימים
    <br />
    האם להמשיך?
  </div>
  <p-footer *ngIf="userService.appData.popUpShow.footer">
    <a
      href="javascript:void(0)"
      role="button"
      class="button-white button-link"
      (click)="userService.appData.popUpShow = false"
    >
      לא, ביטול
    </a>

    <button
      class="button-dark"
      type="button"
      (click)="bankMatchRestart($event)"
    >
      כן, מחיקת תנועות
    </button>
  </p-footer>
</p-dialog>

<p-dialog
		[visible]="(createFromRecommendationData?.visible)"
  (visibleChange)="createFromRecommendationData.visible = $event"
  appendTo="body"
  [modal]="true"
  [styleClass]="'fixed-movement-edit'"
>
  <p-header>{{ createFromRecommendationData?.title }}</p-header>
  <ng-container *ngIf="createFromRecommendationData?.visible">
    <form
      novalidate
      [formGroup]="createFromRecommendationData?.form"
      (ngSubmit)="onSubmitCreateFromRecommendation()"
      *ngIf="createFromRecommendationData"
    >
      <app-fixed-movement-settings
        [form]="createFromRecommendationData.form"
        #createFromRecommendationEditor
        [companyTransTypes]="companyTransTypes"
        [companyId]="userService.appData?.userData?.companySelect?.companyId"
        [source]="createFromRecommendationData.source"
      >
      </app-fixed-movement-settings>
      <button
        type="submit"
        style="display: none"
        [disabled]="createFromRecommendationData.form.invalid"
      ></button>
      <!--{{createFromRecommendationData.form.valid}}-->
    </form>
  </ng-container>
  <p-footer>
    <div
      style="width: 100%; display: flex; justify-content: center"
      *ngIf="createFromRecommendationData"
    >
      <a
        href="#"
        role="button"
        class="button-white button-link"
        (click)="createFromRecommendationData.visible = false"
      >
        {{ 'actions.cancellation' | translate }}
      </a>
      <button
        class="button-dark"
        (click)="onSubmitCreateFromRecommendation()"
        [disabled]="createFromRecommendationData.loading"
      >
        <i
          class="fas fa-fw fa-circle-notch fa-spin"
          *ngIf="createFromRecommendationData.loading"
        ></i>
        {{ createFromRecommendationData.title }}
      </button>
    </div>
  </p-footer>
</p-dialog>

<p-dialog
		[visible]="(deleteConfirmationPrompt?.visible)"
		
  (visibleChange)="deleteConfirmationPrompt.visible = $event"
  styleClass="deleteMovementDialog"
  appendTo="body"
  [style]="{width: 300 + 'px'}"
  [modal]="true"
>
  <p-header>{{ deleteConfirmationPrompt?.title }}</p-header>

  <div
    class="mat-h3"
    [innerHTML]="
      'actions.deleteMovement.body.' +
        deleteConfirmationPrompt?.type +
        '.content' | translate: deleteConfirmationPrompt
    "
  >
    <!--{{('actions.deleteMovement.body.' + deleteConfirmationPrompt?.type + '.content')| translate: deleteConfirmationPrompt}}-->
  </div>
  <ul *ngIf="deleteConfirmationPrompt?.options as options">
    <li *ngFor="let opt of options; index as i">
      <p-radioButton
        name="deleteOption"
        [label]="opt.label"
        [value]="opt.value"
        [inputId]="'deleteOption' + i"
        [(ngModel)]="deleteConfirmationPrompt.optionSelected"
      ></p-radioButton>
      <!--<p-checkbox checkboxIcon="fa fa-check" name="deleteOption" [label]="opt.label" [(ngModel)]="opt.value" [inputId]="'deleteOption'+ i"-->
      <!--[binary]="true"></p-checkbox>-->
      <!--{{opt}}-->
    </li>
  </ul>

  <p-footer>
    <div style="width: 100%; display: flex; justify-content: center">
      <button
        class="button-white button-link"
        (click)="deleteConfirmationPrompt.visible = false"
      >
        {{ 'actions.cancellation' | translate }}
      </button>
      <button
        class="button-dark"
        (click)="deleteConfirmationPrompt.onApprove()"
        [disabled]="deleteConfirmationPrompt?.processing"
      >
        <i
          class="fas fa-fw fa-circle-notch fa-spin"
          *ngIf="deleteConfirmationPrompt?.processing"
        ></i>
        {{ 'actions.remove' | translate }}
      </button>
    </div>
  </p-footer>
</p-dialog>

<p-dialog
		[visible]="(editMovementData?.visible)"
		
  (visibleChange)="editMovementData.visible = $event"
  appendTo="body"
  [modal]="true"
  [styleClass]="'fixed-movement-edit'"
  [resizable]="false"

  #editMovementDataDlg
>
  <p-header>{{ editMovementData?.title }}</p-header>
  <form
    novalidate
    [formGroup]="editMovementData?.form"
    (ngSubmit)="onSubmitEditMovement()"
    *ngIf="editMovementData"
  >
    <app-fixed-movement-settings
      [form]="editMovementData.form"
      #editMovementEditor
      [companyTransTypes]="companyTransTypes"
      [companyId]="userService.appData?.userData?.companySelect?.companyId"
      [source]="editMovementData.source"
      [seriesSource]="editMovementData.seriesSource"
    >
    </app-fixed-movement-settings>
    <button
      type="submit"
      style="display: none"
      [disabled]="editMovementData.form.invalid"
    ></button>
    <!--{{createFromRecommendationData.form.valid}}-->
  </form>
  <p-footer>
    <div
      style="width: 100%; display: flex; justify-content: center"
      *ngIf="editMovementData"
    >
      <a
        href="javascript:void(0)"
        role="button"
        class="button-white button-link"
        (click)="editMovementData.visible = false"
      >
        {{ 'actions.cancellation' | translate }}
      </a>
      <button
        class="button-dark"
        (click)="onSubmitEditMovement()"
        [disabled]="editMovementData.loading"
      >
        <i
          class="fas fa-fw fa-circle-notch fa-spin"
          *ngIf="editMovementData.loading"
        ></i>
        {{ 'actions.saveAndClose' | translate }}
      </button>
    </div>
  </p-footer>
</p-dialog>

<p-dialog (visibleChange)="postponePrompt.visible = false"
		[visible]="(postponePrompt.visible)"
		styleClass="postponeMovementDialog"
  appendTo="body"
  [resizable]="false"

  [modal]="true"
>
  <p-header>{{ 'דחיית תנועה צפוייה' }}</p-header>

  <div style="display: flex; justify-content: space-between">
    <button
      class="button-white button-link"
      (click)="postponePrompt.onDateShortcutClick('nextWeek')"
    >
      {{ 'לשבוע הבא' }}
    </button>
    <button
      class="button-white button-link"
      (click)="postponePrompt.onDateShortcutClick('inTwoWeeks')"
    >
      {{ 'לעוד שבועיים' }}
    </button>
    <button
      class="button-white button-link"
      (click)="postponePrompt.onDateShortcutClick('nextMonth')"
    >
      {{ 'לחודש הבא' }}
    </button>
  </div>

  <p-calendar
    [(ngModel)]="postponePrompt.selectedDate"
    [style]="{ 'min-width': '320px' }"
    [minDate]="postponePrompt?.minDate"
    [inline]="true"
    [locale]="'langCalendar' | translate"
    [showOtherMonths]="false"
    [disabledDays]="[6]"
  ></p-calendar>

  <p-footer>
    <div style="width: 100%; display: flex; justify-content: center">
      <button
        class="button-white button-link"
        (click)="postponePrompt.visible = false"
      >
        {{ 'actions.cancellation' | translate }}
      </button>
      <button
        class="button-dark"
        (click)="postponePrompt.onApprove()"
        [disabled]="postponePrompt?.processing"
      >
        <i
          class="fas fa-fw fa-circle-notch fa-spin"
          *ngIf="postponePrompt?.processing"
        ></i>
        {{ 'actions.approve' | translate }}
      </button>
    </div>
  </p-footer>
</p-dialog>

<ng-template #systemAutoMatch>
  <img
		
     ngSrc="/assets/images/fb-logo-bizibox-32-32.png"
		
		  style="height: auto; width: 16px; position: relative; margin: 0 !important" fill
		
		  [pTooltip]="systemAutoMatchTooltip"
    [escape]="false"
    [tooltipPosition]="'bottom'"
  />
</ng-template>
